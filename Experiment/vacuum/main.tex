\documentclass[uplatex,a4j,11pt,dvipdfmx]{jsarticle}
\usepackage{listings,jvlisting}
\bibliographystyle{jplain}

\usepackage{url}

\usepackage{graphicx}
\usepackage{gnuplot-lua-tikz}
\usepackage{pgfplots}
\usepackage{tikz}
\usepackage{amsmath,amsfonts,amssymb}
\usepackage{bm}
\usepackage{siunitx}

\makeatletter
\def\fgcaption{\def\@captype{figure}\caption}
\makeatother
\newcommand{\setsections}[3]{
\setcounter{section}{#1}
\setcounter{subsection}{#2}
\setcounter{subsubsection}{#3}
}
\newcommand{\mfig}[3][width=15cm]{
\begin{center}
\includegraphics[#1]{#2}
\fgcaption{#3 \label{fig:#2}}
\end{center}
}
\newcommand{\gnu}[2]{
\begin{figure}[hptb]
\begin{center}
\input{#2}
\caption{#1}
\label{fig:#2}
\end{center}
\end{figure}
}

\begin{document}
%\gnu{test}{graph/nopipe/1.tex}
%\gnu{test}{graph/nopipe/2.tex}
%\gnu{test}{graph/nopipe/3.tex}
%\gnu{test}{graph/nopipe/4.tex}
%\gnu{test}{graph/nopipe/5.tex}
\gnu{test}{graph/nopipe/all.tex}
\gnu{test}{graph/thin/all.tex}
\gnu{test}{graph/thick/all.tex}
\bibliography{ref.bib}
\end{document}